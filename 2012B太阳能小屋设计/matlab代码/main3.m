clc,clear
%第三问主程序
%改造后的屋顶
X=xlsread('weather.xls','B1:D8760');
Y=xlsread('weather.xls','I1:J8760');
ts=Y(:,1)+1;
n=ceil((Y(:,2)+1)/24);
level_radio=X(:,1);
scattering_radio=X(:,2);
vertical_radio=X(:,3);
[m,o]=size(X);
a(m)=0;A(m)=0;c(m)=0;C(m)=0;cant_radio(m)=0;
for i=1:m
    if vertical_radio(i)>0
       u=ts(i);
       v=n(i);
       [j,k]=sun_azimuth(u,v);
       a(i)=j;A(i)=k;
    end
end
%选择最适宜角度
for i=1:m
    c(i)=(1+tan(0.75)*tan(a(i))*sqrt(1+tan(A(i))^2))/sqrt(1+tan(0.75)^2)/sqrt(1+tan(A(i))^2+tan(a(i))^2*(1+tan(A(i))^2));
    cant_direct(i)=abs(c(i))*vertical_radio(i);
    cant_radio(i)=cant_direct(i)+scattering_radio(i);
end
broad1(24)=0;
broad1(3)=66;
[COST1,VALUE1]=cost_value(broad1,cant_radio');
%东面
radio2=xlsread('weather.xls','E1:E8760');
broad2(24)=0;
broad2(14)=7;
broad2(15)=4;
broad2(20)=31;
[COST2,VALUE2]=cost_value(broad2,radio2);
%南面
radio3=xlsread('weather.xls','F1:F8760');
broad3(24)=0;
broad3(14)=14;
broad3(18)=2;
broad3(22)=2;
broad3(23)=15;
[COST3,VALUE3]=cost_value(broad3,radio3);
%西面
radio4=xlsread('weather.xls','G1:G8760');
broad4(24)=0;
broad4(14)=8;
broad4(15)=4;
broad4(20)=31;
[COST4,VALUE4]=cost_value(broad4,radio4);
%北面不管怎么排布，都是亏本，不予考虑
year_value=(VALUE2+VALUE3+VALUE4)*0.94+0.973*VALUE1
total_cost=COST1+COST2+COST3+COST4
total_value=year_value*(10+15*0.9+10*0.8)