clc;
clear;

% Φ -> A   纬度
% δ -> F   太阳赤道纬度夹角
% ω -> C   太阳时角
%  h -> Oh  太阳高度角
% λ -> D   经度
%

% 时间
hour = [14	14	14	14	14	14	15	15	15	15	15	15	15	15	15	15	15	15	15	15	15];
minutes = [42	45	48	51	54	57	0	3	6	9	12	15	18	21	24	27	30	33	36	39	42];


Fs = [0.4555 	0.4409 	0.4247 	0.4136 	0.3986 	0.3919 	0.3777 	0.3656 	0.3582 	0.3481 	0.3438 	0.3305 	0.3264 	0.3169 	0.3120 	0.3069 	0.2987 	0.2928 	0.2876 	0.2853 ];

Fs1 = [0.498223121	0.481358967	0.465600981	0.450860543	0.437057586	0.424119658	0.4119811	0.400582314	0.38986913	0.379792235	0.370306676	0.36137142	0.352948959	0.345004964	0.337507975	0.330429126	0.323741899	0.317421906	0.311446691	0.305795555
];

Fs2 = [0.672652386	0.647445048	0.623892866	0.601865062	0.581242791	0.561917976	0.54379225	0.526776004	0.510787532	0.49575226	0.481602058	0.468274622	0.455712913	0.443864662	0.43268192	0.422120659	0.412140407	0.402703925	0.393776915	0.385327758
];

Fs3 = [1.079420153	1.034553984	0.992426513	0.952864404	0.915702263	0.880783248	0.847959366	0.817091528	0.788049431	0.760711309	0.734963612	0.710700612	0.687823995	0.666242421	0.645871089	0.626631312	0.608450092	0.591259726	0.57499742	0.559604931
];


LArr = [1.6	1.7	1.7	1.8	2	2	2	2.2	2.2	2.4	2.6	2.7];
JArr = [115	114	114	111	107	109	109	104	106	100	100	99];
WArr = [5	10	11	2	-1	19	20	-2	21	-5	24	24];

% 4月18日是一年的第 108 天
n = 108;

ii = 11;


%地理位置 北纬39度54分26秒,东经116度23分29秒
% 杆长 L = 3 m
L = LArr(ii);
% 经度
J = JArr(ii);
% 纬度
W = WArr(ii);
% 时区经度
Jm = 120;

% 太阳赤纬夹角（度）
C = 23.45*sin(2*pi*(284+n)/365);

% 太阳时
B = 2*pi*(n -81)/364;
E = 9.87*sin(2*B) - 7.53*cos(B) - 1.5*sin(B); 


X = [];


% T0： m 时 n 分  
% 9:00-15:00
% m = [9, 15]  n = [0, 59]
for i=1:1:21
    
    
        
    T0 = hour(i) + minutes(i)/60;
    

    X(i) = T0;


    


    
    

    
end


plot(X, Ls, '*');
hold on;
plot(X, Ls1, 'r');
%axis([9 15 22 40]);

xlabel('时间');
ylabel('方位角（°）');
title('(24°N, 100°E)');
legend('实际值' ,'预测曲线');





