

clear;
H = [0.089776383	0.089852984	0.603826637	0.115148572	0.119130007	0.19054591	0.149766394	0.119751015	0.144818961	0.114356492	0.14332982	0.163428567	0.20793413	1.032719274	0.120579025	0.081273671	0.116956479	0.344038351	0.104999652	0.12016502	0.114059463	0.130722153	0.088627368	0.14407439	0.11778449	0.090235989	0.118819503	0.117163482	0.087784757	0.122959555	0.114455502	0.119337009	0.118198495	0.116335471	0.081043868	0.113644437	0.126429795	0.128478163	0.112673323	0.111089164	0.10481955	0.143038809	0.164554537	0.10328868	0.114455502	0.118923004	0.116749477	0.103468782	0.140103348	0.112079264	0.086865545	0.086252737	0.085103722	0.086865545	0.086176136	0.081809878	0.086865545	0.081350272	0.112277283	0.085639929	0.116542474	0.153897431	0.128364365	0.111188174	0.116956479	0.127795374	0.171375309	0.101487657	0.115921466	0.118094994	0.086252737	0.142088869	0.139482872	0.140227443	0.100767247	0.101487657	0.139979253	0.086865545	0.110891144	0.080967267	0.138738302	0.128819557	0.140972013	0.137967245	0.139731063	0.08571653	0.110396094	0.086022934	0.087937959	0.119337009	0.110594114	0.115507461	0.140103348	0.111683224	0.139855158	0.086712343	0.111782234	0.100407043	0.128819557	0.111485204	0.085639929	0.100407043	0.138862397	0.085639929	0.140599728	0.128250566	0.115196957	0.141592489	0.140599728	0.086176136	0.127226383	0.126884988	0.116335471	0.135647449	0.139731063	0.116438973	0.101577708	0.127795374	0.101667759	0.112376293	0.101487657	0.086022934	0.111188174	0.139979253	0.085486727	0.101667759	0.101037401	0.140103348	0.140227443	0.127567777	0.130298934	0.086176136	0.110594114	0.111584214	0.08724855	0.116645975	0.141964774	0.128364365	0.11467945	0.110693124	0.131550714	0.128250566	0.08648254	0.111188174	0.699027598	0.144694866	0.101397605	0.112079264	0.128478163	0.111881244	0.111188174	0.144570771	0.088474166	0.111980254	0.140599728	0.141840679	0.140723823	0.127226383	0.191726902	0.128136768	0.111287184	0.086712343	0.131095521	0.149658669	0.103648884	0.101127452	0.101307554	0.128136768	0.100587145	0.102568271	0.195325659	0.169017638	0.161323607	0.228831332	0.16628741	0.250576669	0.127226383	0.11623197	0.122131545	0.128819557	0.111287184	0.141220204	0.12009907	0.109604015	0.111782234	0.287454242	0.110990154	0.112277283	0.086788944	0.139830269	0.239772798	0.119751015	0.117516763	0.110891144	0.137125066	0.17709074	0.110396094	0.163983161	0.115247582	0.085793131	0.12358484	0.08571653	0.148665908	0.120693129	0.147176767	0.11778449	0.193836518	0.112871343	0.141188189	0.133402213	0.109604015	0.101127452	0.144694866	0.141344299	0.128364365	0.149906859	0.109009955	0.110990154	0.128250566	0.08495052	0.099326429	0.101037401	0.126202199	0.127567777	0.131323118	0.113762433	0.127681575	0.112772333	0.129616145	0.139482872	0.189467639	0.111782234	0.129160952	0.128136768	0.112178274	0.140227443	0.129616145	0.14308163	0.127681575	0.116732731	0.108712925
];
a1=-194.7;
b1=-13.4;
c1=15.6;
d1=-0.5;
a2=-194.8;
b2=-9.6;
c2=14.8;
d2=-0.5;
a3=-159.7;
b3=-14.5;
c3=14.8;
d3=-0.5;

% 代号-得分-等级
E_Z_DJ = [
1	0.1172	9
2	0.1173	9
12	0.5834	7
25	0.1163	7
34	0.1151	7
38	0.1841	7
45	0.1447	7
47	0.1157	7
49	0.1167	7
53	0.1155	7
56	0.1155	7
60	0.1579	7
61	0.2009	7
62	0.8322	7
63	0.1165	7
64	0.1061	5
66	0.113	5
69	0.3324	5
71	0.1166	7
73	0.1161	7
75	0.1152	7
76	0.1263	5
77	0.1157	7
78	0.1161	7
80	0.1138	5
82	0.1178	7
86	0.1148	7
87	0.1132	5
88	0.1146	5
89	0.1188	5
90	0.1156	7
91	0.1153	7
92	0.1142	5
93	0.1124	5
94	0.1058	5
95	0.1098	5
96	0.1111	5
98	0.1129	5
99	0.1138	7
100	0.1122	5
102	0.1164	7
103	0.1382	7
104	0.1662	7
105	0.1147	7
106	0.1156	7
107	0.1149	5
108	0.1128	5
109	0.1149	7
110	0.1129	5
111	0.1132	5
112	0.1134	5
113	0.1126	5
114	0.1111	5
115	0.1134	5
116	0.1125	5
117	0.1068	5
118	0.1134	5
119	0.1062	5
120	0.1134	5
121	0.1118	5
122	0.1126	5
123	0.1709	5
124	0.1128	5
125	0.1123	5
126	0.113	5
127	0.1123	5
128	0.1381	5
129	0.1127	5
130	0.112	5
131	0.1141	5
132	0.1126	5
133	0.1145	5
134	0.1124	5
135	0.113	5
136	0.1119	5
137	0.1127	5
138	0.1128	5
139	0.1134	5
140	0.112	5
141	0.1057	5
142	0.1118	5
143	0.1132	5
144	0.1136	5
145	0.1333	5
146	0.1126	5
147	0.1119	5
148	0.1115	5
149	0.1123	5
150	0.1148	5
151	0.1153	5
152	0.1117	5
153	0.1116	5
154	0.1129	5
155	0.1128	5
156	0.1127	5
157	0.1132	5
158	0.1129	5
159	0.1115	5
160	0.1132	5
161	0.1126	5
162	0.1118	5
163	0.1115	5
164	0.1119	5
165	0.1118	5
166	0.1133	5
167	0.1127	5
168	0.1113	5
169	0.1141	5
170	0.1133	5
171	0.1125	5
172	0.1118	5
173	0.1115	5
174	0.1124	5
175	0.1192	5
176	0.1126	5
177	0.1125	5
178	0.1128	5
179	0.1123	5
180	0.1129	5
181	0.1135	5
182	0.1127	5
183	0.1123	5
184	0.1123	5
185	0.1128	5
186	0.1116	5
187	0.1129	5
188	0.1122	5
189	0.1129	5
190	0.113	5
191	0.1121	5
192	0.1145	5
193	0.1125	5
194	0.1117	5
195	0.1127	5
196	0.1139	5
197	0.1127	5
198	0.1144	5
199	0.1128	5
200	0.1108	5
201	0.1118	5
202	0.1156	5
203	0.1127	5
204	0.1129	5
205	0.1123	5
206	0.5633	5
207	0.1166	5
208	0.1126	5
209	0.1132	5
210	0.1129	5
211	0.113	5
212	0.1123	5
213	0.1165	5
214	0.1155	5
215	0.1131	5
216	0.1133	5
217	0.1143	5
218	0.1134	5
219	0.1118	5
220	0.1545	5
221	0.1126	5
222	0.1124	5
223	0.1132	5
224	0.1152	5
225	0.1206	5
226	0.1151	5
227	0.1123	5
228	0.1125	5
229	0.1126	5
230	0.1117	5
231	0.1139	5
232	0.1574	5
233	0.1633	5
234	0.13	5
235	0.1844	5
236	0.134	5
237	0.2421	5
238	0.1118	5
239	0.1123	5
240	0.118	5
241	0.1132	5
242	0.1124	5
243	0.1138	5
244	0.1213	5
245	0.1107	5
246	0.1129	5
247	0.2526	5
248	0.1121	5
249	0.1134	5
250	0.1133	5
251	0.1351	5
252	0.2107	5
253	0.1157	5
254	0.1305	5
255	0.112	5
256	0.1105	5
257	0.1711	5
258	0.1115	5
259	0.1821	5
260	0.1164	5
261	0.112	5
262	0.1086	5
263	0.1119	5
264	0.1198	5
265	0.1219	5
266	0.1186	5
267	0.1138	5
268	0.1562	5
269	0.114	5
270	0.1426	5
271	0.1075	5
272	0.1107	5
273	0.1123	5
274	0.1166	5
275	0.1139	5
276	0.1128	5
277	0.1208	5
278	0.1101	5
279	0.1121	5
280	0.1127	5
281	0.1109	5
282	0.1103	5
283	0.1122	5
284	0.1109	5
285	0.1121	5
286	0.1154	5
287	0.1149	5
288	0.1122	5
289	0.1139	5
290	0.1139	5
291	0.1124	5
292	0.2104	5
293	0.1129	5
294	0.1135	5
295	0.1126	5
296	0.1133	5
297	0.113	5
298	0.1139	5
299	0.1153	5
300	0.1122	5
301	0.1179	5
302	0.1098	5


];
E = E_Z_DJ(:, 1);
DJ = E_Z_DJ(:, 3);
Z = E_Z_DJ(:, 2);


fun_range = [0,3.08;0,2.1];    %每个维度的求解范围，行代表维度，第一列最小值，第二列最大值
density = 0.01;                         %图像中取点的密度
d = 2;                                  %维度
popsize = 10;                           %种群大小
maxgen = 100;                           %最大迭代次数
limit_v = 10;                           %最大运动速度
maxormin = 0;                           %求最大值还是最小值。最大值为1，最小值为0
dynamic = 1;                            %是否采用动态参数
W = [0.7,1.4];                          %惯性因子
C2 = [0.5,2.5];
C1 = [0.5,2.5];                         %学习因子。


ZZ = pso1_im(funct,fun_range,density,d);
[x,v,fitness,pbest,gbest,gbest_fitness,gbest_index,pbest_fitness] =...
   pso1_in(funct,popsize,d,fun_range,limit_v,maxormin);
[gbest_fitness,gbest_index,record] =...
    pso1_in2(funct,d,popsize,maxgen,dynamic,W,C1,C2,fun_range,limit_v,density...
    ,x,v,fitness,pbest,gbest,gbest_fitness,gbest_index,pbest_fitness,maxormin);



T = 1;  %周期为 1 年
M = 10000; % 总贷款额度1亿

Sigma = [];
DD = [];
Beta = [];
W = [];         % 利润，即最大化目标

Z_S = ones(1, length(E));  % 每个利率  1不用管
Z_D = ones(1, length(E));  % 每个投资

N = 1000000;    % 迭代次数

nnn = 0;
for i=1:1:N
    Sigma = [];         % 该次的利率
    DD = [];            % 该次的贷款
    w = 0;              % 该次的目标值
    for j=1:length(E)
        Sigma(j) = 0.04 + (0.15-0.04).*rand(1,1);
        x = Sigma(j);
        DD(j) = 10 + (100-10).*rand(1,1);
        d = DD(j);
        if DJ(j) == 1
           Beta(j) =  a1*x^3+b1*x^2+c1*x+d1;
        elseif DJ(j) == 2
            Beta(j) =  a2*x^3+b2*x^2+c2*x+d2;
        else
            Beta(j) =  a3*x^3+b3*x^2+c3*x+d3;
        end
        w = w + d*x*(1-Beta(j))*Z(j)*H(j);
    end
    if w > 12.5
        nnn  = nnn+1;
        W(nnn) = w;
        Z_S(nnn,:) = Sigma(:);
        Z_D(nnn,:) = DD(:);
    end
end

XX = 1:1:nnn;
plot(XX, W, '*');
           
for i=1:length(Z_S(:, 1))
    sum(Z_D(i,:))
end
            
        
        

